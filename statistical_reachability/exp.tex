\section{Experiments}


We demonstrate the feasibility of our method by applying {\bf SReach} to representative hybrid systems with both nonlinear dynamics and parametric uncertainty. 
The tool is open-source and available at \url{https://github.com/rachelwang/SReach}. 
All benchmarks and data shown in here are also accessible on the tool website. All experiments were conducted on a machine with 2.9GHz Intel Core i7 processor and 8GB RAM, running OS X 10.9.2. 
In our experiments we used $0.001$ as the precision for the $\delta$-decision problem; Bayesian estimation
with $\delta' = 0.01$, coverage probability $0.99$, and uniform prior ($\alpha = \beta = 1$). 


\subsection{Prostate cancer treatment}

\textit{Model Description}.
We modified the model of the intermittent androgen suppression (IAS) therapy in \cite{tanaka2010mathematical} by adding parametric uncertainty. The IAS therapy switches between  treatment-on, and treatment-off with respect to the serum level thresholds of prostate-specific antigen (PSA) - $r_0$ and $r_1$. As suggested by the clinical trials \cite{bruchovsky2006final}, an effective IAS therapy highly depends on the individual patient. Thus, we modified the model by taking the parametric variation caused by the personalized differences into account. In details, according to the clinic data from hundreds of patients \cite{bruchovsky2007locally}, we replaced 6 system parameter with random variables with appropriate (continuous) distributions, including $\alpha_x$ (the proliferation rate of AD cells), $\alpha_y$ (the proliferation rate of AI cells), $\beta_x$ (the apoptosis rate of AD cells), $\beta_y$ (the apoptosis rate of AI cells), $m_1$ (the mutation rate from AD to AI cells), and $z_0$ (the normal androgen level).
\begin{table}[h]
\centering
    \begin{tabular}{c|c|c|c|c|c|c|c|c}
    \hline
    Model & \#RVs & $r_0$ & $r_1$ & Est\_P & \#S\_S & \#T\_S & Avg\_T(s) & Tot\_T(s) \\ \hline
    PCT1  & 6     & 5.0  & 10.0 & 0.04   & 0      & 227    & 0.145   & 32.915     \\ \hline
    PCT2  & 6     & 7.0  & 11.0 & 0.591  & 2144   & 3628   & 432.491 & 1569077.348     \\ \hline
    PCT3  & 6     & 10.0 & 15.0 & 0.996  & 227    & 227    & 692.861   & 157279.446   \\ \hline
    \end{tabular}
    \caption {\#RVs = number of random variables in the model, \#S\_S = number of $\delta$-sat samples, 
\#T\_S = total number of samples, $r_0$ = lower threshold of the serum PSA level, $r_1$ = upper threshold, 
Est\_P = estimated probability of the property,  Avg\_T(s) = average CPU time of each sample in seconds, and Tot\_T(s) = total CPU time for all samples in seconds.}
    \label{table:prostate}
\end{table}

\textit{Experiments and Results}. To describe the variations due to individual difference, we assigned $\alpha_x$ to be $U(0.0193, 0.0214)$, $\alpha_y$ to be $U(0.0230, 0.0254)$, $\beta_x$ to be $U(0.0072, 0.0079)$, $\beta_y$ to be $U(0.0160, 0.0176)$, $m_1$ to be $U(0.0000475, 0.0000525) $, and $z_0$ to be $N(30.0, 0.001)$. 
We used {\bf SReach} to estimate the probabilities of the model preventing the relapse of the prostate cancer with three distinct pairs of treatment thresholds (\ie, combinations of $r_0$ and $r_1$).  In the experiments, we chose 2 as the unfolding steps. For each sample generated, {\bf SReach} dealt with $41$ variables, and $10$ ODEs. As shown in Table \ref{table:prostate}, the model with thresholds $r_0 = 10$, and $r_1 = 15$ has the probability approaching to 1, indicating that these thresholds can be considered for the general treatment. 

\subsection{Application to cardiac models}

\textit{Model Description}.
The minimum resistor model (MRM) reproduces experimentally measured characteristics 
of human ventricular cell dynamics \cite{bueno2008minimal}. 
The MRM reduces the complexity of existing models by representing channel gates of different ions with one fast channel, and two slow gates. However, due to this reduction, for most model parameters, it becomes impossible to obtain their values through measurements. With this application, we will show that {\bf SReach} can also be adopted to identify appropriate ranges and distributions for model parameters, \ie, parameter estimation.
\begin{table}[h]
\centering
    \begin{tabular}{c|c|c|c|c|c|c|c|c}
    \hline
    Model         & \#RVs & EPI\_TO1            & EPI\_TO2         & \#S\_S & \#T\_S & Est\_P &  A\_T(s) & T\_T(s) \\ \hline
    Cd\_to1\_s    & 1     & U(6.1e-3, 7e-3)    & 6              & 227       & 227      & 0.996     & 0.362   & 82.174     \\ \hline
    Cd\_to1\_uns  & 1     & U(5.5e-3, 5.9e-3)   & 6              & 0         & 227      & 0.004     & 0.124 & 28.148       \\ \hline
    Cd\_to2\_s    & 1     & 400               & U(0.131, 6)    & 227       & 227      & 0.996     & 0.361  & 81.947      \\ \hline
    Cd\_to2\_uns  & 1     & 400               & U(0.1, 0.129)    & 0         & 227      & 0.004     & 0.139   & 31.552     \\ \hline
    Cd\_to12\_s   & 2     & N(400, 1e-4)      & N(6, 1e-4)     & 227       & 227      & 0.996     & 0.373  & 84.671      \\ \hline
    Cd\_to12\_uns & 2     & N(5.5e-3, 10e-6) & N(0.11, 10e-5) & 0         & 227      & 0.004     & 0.131  & 29.737      \\ \hline
    \end{tabular}
    \caption { \#RVs = number of random variables in the model, \#S\_S = number of $\delta$-sat samples, 
\#T\_S = total number of samples, Est\_P = estimated probability of property,  A\_T(s) = average 
CPU time of each sample in seconds, and T\_T(s) = total CPU time for all samples in seconds.}
    \label{table:cardiac}
\end{table}

\textit{Experiments and Results}. To illustrate the way that {\bf SReach} is used to conduct parameter estimation, we chose two system parameters - $EPI\_TO1$, and $EPI\_TO2$, and varied their distributions to see with which distributions for these two system parameters, the model can present the desired pattern. The model has 4 modes. In the experiments, we chose $3$ as the unfolding steps. For each sample generated, {\bf SReach} dealt with $62$ variables, and $24$ ODEs. As in the Table \ref{table:cardiac}, when $EPI\_TO1$ is either close to $400$, or between $0.0061$ and $0.007$, and $EPI\_TO2$ is close to $6$, the model can satisfy the given bounded reachability property with a probability very close to $1$. 

\begin{comment}

\subsection{Application to the stabilization control of quadcopters}

\textit{Model Description}.
We modeled the stabilization control of a quadcopter, and are interested in analyzing its robustness. In other words, given an arbitrary initial location and position, this model will guarantee that the quadcopter will soon become stable via adjusting velocities of four rotors. To specify the arbitrary initial status, we introduced 6 random variables: ($x_0$, $y_0$, $z_0$) (the initial location),  $\phi_0$ (the initial roll angle), $\theta_0$ (the initial pitch angle), and $\psi_0$ (the initial yaw angle).

\textit{Experiments and Results}. To validate this model, {\bf SReach} was adopted with the BIFT statistical testing option.  

\end{comment}


\subsection{Additional benchmarks}
To further demonstrate the feasibility of {\bf SReach}, we also applied it to the following benchmarks. Table \ref{table:exp} shows the results of experiments. BB refers to the bouncing ball models, Tld the thermostat model with linear temperature decrease, Ted the thermostat model with exponential decrease, DT the dual\_therm-\\ostat models, W the watertank models, DW the dual\_watertank models, Gear the gear shift control model, Que the model for queuing system, 3dOsc the model for 3d oscillator, and QuadC the model for quadcopter stabilization control. 
\begin{table}[h]
\centering
    \begin{tabular}{c|c|c|c|c|c|c|c|c|c|c|c}
    \hline
    Benchmark & \#Ms & K & \#ODEs & \#Vs & \#RVs & $\delta$ & Est\_P & \#S\_S & \#T\_S &  A\_T(s) & T\_T(s)  \\ \hline
    BBK1      & 1       & 1 & 2      & 14    & 3     & 0.001 & 0.754  & 5372      & 7126     & 0.086  & 612.836         \\ \hline
    BBK5      & 1       & 5 & 2      & 38    & 3     & 0.001 & 0.059  & 209       & 3628     & 0.253   &  917.884       \\ \hline
    BBwDv1    & 2       & 2 & 4      & 20    & 4     & 0.001 & 0.208  & 2206      & 10919    & 0.080   &  873.522     \\ \hline
    BBwDv2K2  & 2       & 2 & 4      & 20    & 3     & 0.001 & 0.845  & 7330      & 8669     & 0.209    & 1811.821      \\ \hline
    BBwDv2K8  & 2       & 8 & 4      & 56    & 3     & 0.001 & 0.207  & 2259      & 10901    & 0.858  & 9353.058        \\ \hline
    Tld       & 2       & 7 & 2      & 33     & 4     & 0.001 & 0.996      & 227         & 227        & 0.213     & 48.351         \\ \hline
    Ted       & 2       & 7 & 4      & 50     & 4     & 0.001 & 0.996      & 227         & 227       & 12.839   & 2914.448     \\ \hline
    DTldK3    & 2       & 3 & 4      & 26    & 2     & 0.001 & 0.996  & 227       & 227      & 0.382    & 86.714      \\ \hline
    DTldK5    & 2       & 5 & 4      & 38    & 2     & 0.001 & 0.161  & 1442      & 8961     & 0.280  &  2509.078       \\ \hline
    W4mv1       & 4       & 3 & 8      & 26     & 6     & 0.001 & 0.381      & 5953         & 15639        & 0.238   & 3722.082     \\ \hline
    W4mv2K3       & 4       & 3 & 8      & 26     & 6     & 0.001 & 0.996      & 227         & 227        & 0.673   & 152.771      \\ \hline
    W4mv2K7       & 4       & 7 & 8      & 50     & 6     & 0.001 & 0.004     & 0         & 227        & 0.120    & 27.240          \\ \hline
    DWK1      & 2       & 1 & 4      & 14    & 5     & 0.001 & 0.996  & 227       & 227      & 0.171   & 38.817      \\ \hline
    DWK3      & 2       & 3 & 4      & 26    & 5     & 0.001 & 0.996  & 227       & 227      & 0.215    & 48.806      \\ \hline
    DWK9      & 2       & 9 & 4      & 62    & 5     & 0.001 & 0.996  & 227       & 227      & 5.144   &  1167.688      \\ \hline
    Gear      & 4       & ~ & ~      & ~     & ~     & 0.001 & ~      & ~         & ~        & ~     & ~          \\ \hline
    Que       & 3       & 2 & ~      & ~     & ~     & 0.001 & 0.228      & 2662         & 11677        & 0.095   & 1109.315   \\ \hline
    3dOsc     & 3       & 2 & 18      & 48     & 2     & 0.001 & 0.996      & 227         & 227        & 8.273  & 1877.969   \\ \hline
    QuadC     & 1       & 0 & 14      & 44     & 6     & 0.001 & 0.996      & 227         & 227        & 825.641 & 187420.507   \\ \hline
    \end{tabular}
    \caption {\#Ms = number of modes, K indicates the unfolding steps, \#ODEs = number of ODEs in the model, \#Vs = number of total variables in the unfolded formulae, \#RVs = number of random variables in the model, $\delta$ = precision used in 
{\bf dReach}, \#S\_S = number of $\delta$-sat samples , \#T\_S = total number of samples, Est\_P = estimated 
probability of the property,  A\_T(s) = average CPU time of each sample in seconds, and T\_T(s) = total CPU time for all samples in seconds.}
    \label{table:exp}
\end{table}
